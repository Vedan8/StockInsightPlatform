{% extends "base.html" %}
{% load tailwind_tags %}
{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto mt-12 px-6 py-8 bg-gradient-to-br from-white via-blue-50 to-blue-100 rounded-xl shadow-lg">
  <h1 class="text-3xl font-bold text-center text-blue-900 mb-8">ğŸ“ˆ Stock Prediction</h1>

  {% if error %}
    <div class="bg-red-50 border-l-4 border-red-400 text-red-700 px-4 py-3 rounded mb-6">
      {{ error }}
    </div>
  {% endif %}

  <form id="predict-form" method="POST" class="space-y-6">
    {% csrf_token %}
    <div>
      <label for="ticker" class="block text-sm font-medium text-gray-700 mb-1">Ticker Symbol</label>
      <input
        type="text"
        name="ticker"
        id="ticker"
        placeholder="e.g., TSLA"
        required
        autocomplete="off"
        class="w-full px-4 py-2 border border-blue-300 rounded-md bg-white focus:ring-2 focus:ring-blue-300 focus:border-blue-400 shadow-sm transition"
      >
    </div>
    <button type="submit" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2.5 rounded-md shadow transition">
      ğŸ” Predict
    </button>
  </form>

  {% if not is_paid %}
  <form action="/create-checkout-session/" method="GET" class="mt-4">
    <button class="w-full bg-yellow-400 hover:bg-yellow-500 text-gray-900 font-semibold py-2.5 rounded-md shadow transition">
      ğŸ’ Upgrade to Premium
    </button>
  </form>
  {% endif %}

  {% if prediction %}
    <div class="mt-6 bg-green-50 border-l-4 border-green-400 text-green-800 px-4 py-3 rounded">
      âœ… Prediction for <strong>{{ prediction.ticker }}</strong>: â‚¹{{ prediction.predicted_price }}
    </div>
  {% endif %}

  {% if chart1_url and chart2_url %}
  <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 mt-6">
    <img src="/{{ chart1_url }}" alt="Chart 1" class="rounded-lg border border-blue-100 shadow-sm" />
    <img src="/{{ chart2_url }}" alt="Chart 2" class="rounded-lg border border-blue-100 shadow-sm" />
  </div>
  {% endif %}

  <div class="mt-10">
    <h2 class="text-2xl font-semibold text-blue-900 border-b pb-2 mb-4">ğŸ“œ Past Predictions</h2>
    <ul class="space-y-2 text-gray-800 list-disc list-inside">
      {% for p in past_predictions %}
        <li>{{ p.ticker }} â€“ â‚¹{{ p.predicted_price }} â€“ {{ p.created_at|date:"d M Y, H:i" }}</li>
      {% empty %}
        <li>No predictions yet.</li>
      {% endfor %}
    </ul>
  </div>
</div>
{% endblock %}
